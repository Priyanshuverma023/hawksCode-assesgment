<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Psychometric Soft Skills Assessment Tool">
  <title>Soft Skills Assessment</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <link rel="stylesheet" href="css/style.css">
  <style>
    /* Google Calendar Reminder Widget */
    .gcal-reminder-section {
      margin-top: 36px;
      padding-top: 28px;
      border-top: 1.5px solid var(--border-subtle);
      width: 100%;
    }
    .gcal-reminder-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 16px;
    }
    .gcal-reminder-icon {
      width: 36px;
      height: 36px;
      background: linear-gradient(135deg, #4285F4 0%, #34A853 100%);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      box-shadow: 0 4px 12px rgba(66, 133, 244, 0.25);
    }
    .gcal-reminder-title-wrap { flex: 1; min-width: 0; }
    .gcal-reminder-title {
      font-size: 13px;
      font-weight: 700;
      color: var(--text-dark);
      margin-bottom: 2px;
      font-family: 'DM Serif Display', serif;
    }
    .gcal-reminder-sub {
      font-size: 10px;
      color: var(--text-dim);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 600;
    }
    .gcal-reminder-body {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    .gcal-form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .gcal-form-group { display: flex; flex-direction: column; }
    .gcal-label {
      font-size: 10px;
      font-weight: 700;
      color: var(--text-dark);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 5px;
    }
    .gcal-input, .gcal-textarea {
      width: 100%;
      padding: 10px 12px;
      background: linear-gradient(135deg, #fafaf8 0%, #f5f4ed 100%);
      border: 1.5px solid var(--border-subtle);
      border-radius: 8px;
      font-family: inherit;
      font-size: 12px;
      color: var(--text-dark);
      transition: all var(--trans);
      outline: none;
      box-sizing: border-box;
    }
    .gcal-textarea { resize: vertical; min-height: 60px; }
    .gcal-input::placeholder, .gcal-textarea::placeholder { color: var(--text-dim); }
    .gcal-input:focus, .gcal-textarea:focus {
      border-color: #4285F4;
      background: #f8fbff;
      box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.10);
    }
    .gcal-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      width: 100%;
      padding: 11px 16px;
      background: linear-gradient(135deg, #4285F4 0%, #1a73e8 100%);
      color: #ffffff;
      border: none;
      border-radius: 8px;
      font-family: inherit;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
      transition: all var(--trans);
      text-transform: uppercase;
      letter-spacing: 0.04em;
      margin-top: 2px;
      box-shadow: 0 4px 14px rgba(66, 133, 244, 0.3);
    }
    .gcal-btn:hover {
      background: linear-gradient(135deg, #1a73e8 0%, #1558b0 100%);
      transform: translateY(-1px);
      box-shadow: 0 6px 18px rgba(66, 133, 244, 0.4);
    }
    .gcal-btn:active { transform: translateY(0); }
    .gcal-error {
      font-size: 10px;
      color: var(--error);
      margin-top: 3px;
      min-height: 13px;
      display: block;
    }
    .gcal-success-msg {
      display: none;
      align-items: center;
      gap: 8px;
      background: rgba(52, 168, 83, 0.10);
      border: 1.5px solid rgba(52, 168, 83, 0.3);
      border-radius: 8px;
      padding: 10px 12px;
      font-size: 11px;
      font-weight: 600;
      color: #166534;
      margin-top: 6px;
    }
    .gcal-success-msg.show { display: flex; }
    .my-events-btn-wrap { margin-top: 16px; width: 100%; }
    .my-events-toggle-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      width: 100%;
      padding: 11px 16px;
      background: linear-gradient(135deg, #ffffff 0%, #f5f4ed 100%);
      color: var(--text-dark);
      border: 1.5px solid var(--border-subtle);
      border-radius: 8px;
      font-family: inherit;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
      transition: all var(--trans);
      text-transform: uppercase;
      letter-spacing: 0.04em;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      position: relative;
    }
    .my-events-toggle-btn:hover {
      border-color: #4285F4;
      background: #f0f5ff;
      box-shadow: 0 4px 16px rgba(66,133,244,0.15);
      transform: translateY(-1px);
    }
    .my-events-badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 18px;
      height: 18px;
      padding: 0 5px;
      background: #4285F4;
      color: #fff;
      border-radius: 20px;
      font-size: 9px;
      font-weight: 800;
      letter-spacing: 0;
    }
    .my-events-panel {
      display: none;
      margin-top: 12px;
      background: linear-gradient(135deg, #ffffff 0%, #fafaf8 100%);
      border: 1.5px solid #c5d8fb;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(66,133,244,0.10);
      animation: panelSlideIn 0.3s cubic-bezier(0.4,0,0.2,1);
    }
    .my-events-panel.open { display: block; }
    @keyframes panelSlideIn {
      from { opacity: 0; transform: translateY(-8px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .my-events-panel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 16px 12px;
      background: linear-gradient(135deg, #4285F4 0%, #1a73e8 100%);
    }
    .my-events-panel-title {
      font-size: 13px;
      font-weight: 700;
      color: #fff;
      font-family: 'DM Serif Display', serif;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .my-events-panel-close {
      width: 28px;
      height: 28px;
      background: rgba(255,255,255,0.15);
      border: none;
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 14px;
      transition: all var(--trans);
    }
    .my-events-panel-close:hover { background: rgba(255,255,255,0.3); }
    .my-events-list {
      max-height: 360px;
      overflow-y: auto;
      padding: 10px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      scrollbar-width: thin;
      scrollbar-color: #c5d8fb transparent;
    }
    .my-events-list::-webkit-scrollbar { width: 4px; }
    .my-events-list::-webkit-scrollbar-track { background: transparent; }
    .my-events-list::-webkit-scrollbar-thumb { background: #c5d8fb; border-radius: 4px; }
    .event-card {
      background: #f8fbff;
      border: 1.5px solid #e0ecff;
      border-radius: 10px;
      padding: 12px 12px 10px;
      transition: all var(--trans);
      position: relative;
    }
    .event-card:hover { border-color: #4285F4; box-shadow: 0 4px 16px rgba(66,133,244,0.12); }
    .event-card.editing { border-color: #4285F4; background: #f0f6ff; box-shadow: 0 4px 20px rgba(66,133,244,0.18); }
    .event-view { display: flex; flex-direction: column; gap: 4px; }
    .event-view__title { font-size: 13px; font-weight: 700; color: var(--text-dark); padding-right: 60px; word-break: break-word; }
    .event-view__meta { display: flex; flex-wrap: wrap; gap: 6px; align-items: center; }
    .event-chip {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 10px;
      font-weight: 600;
      color: #1558b0;
      background: rgba(66,133,244,0.10);
      border-radius: 5px;
      padding: 3px 7px;
    }
    .event-chip.past { color: #888; background: rgba(0,0,0,0.05); }
    .event-chip.future { color: #166534; background: rgba(52,168,83,0.10); }
    .event-view__desc { font-size: 11px; color: var(--text-gray); line-height: 1.5; margin-top: 2px; word-break: break-word; }
    .event-actions { position: absolute; top: 10px; right: 10px; display: flex; gap: 5px; }
    .event-action-btn {
      width: 26px;
      height: 26px;
      border-radius: 6px;
      border: 1px solid var(--border-subtle);
      background: #fff;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--trans);
      color: var(--text-gray);
      font-size: 13px;
    }
    .event-action-btn:hover { background: #f0f5ff; border-color: #4285F4; color: #1a73e8; }
    .event-action-btn.delete:hover { background: #fff0f0; border-color: #ef4444; color: #ef4444; }
    .event-edit { display: none; flex-direction: column; gap: 8px; }
    .event-card.editing .event-view { display: none; }
    .event-card.editing .event-edit { display: flex; }
    .event-card.editing .event-actions { display: none; }
    .edit-row { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
    .edit-field { display: flex; flex-direction: column; gap: 4px; }
    .edit-label { font-size: 9px; font-weight: 700; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.06em; }
    .edit-input, .edit-textarea {
      padding: 7px 9px;
      background: #fff;
      border: 1.5px solid #c5d8fb;
      border-radius: 6px;
      font-family: inherit;
      font-size: 11px;
      color: var(--text-dark);
      outline: none;
      transition: all var(--trans);
      width: 100%;
      box-sizing: border-box;
    }
    .edit-input:focus, .edit-textarea:focus { border-color: #4285F4; box-shadow: 0 0 0 2px rgba(66,133,244,0.12); }
    .edit-textarea { resize: vertical; min-height: 48px; }
    .edit-btns { display: flex; gap: 7px; justify-content: flex-end; margin-top: 4px; }
    .edit-save-btn {
      padding: 7px 14px;
      background: linear-gradient(135deg, #4285F4 0%, #1a73e8 100%);
      color: #fff;
      border: none;
      border-radius: 6px;
      font-family: inherit;
      font-size: 11px;
      font-weight: 700;
      cursor: pointer;
      transition: all var(--trans);
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }
    .edit-save-btn:hover { background: linear-gradient(135deg, #1a73e8 0%, #1558b0 100%); transform: translateY(-1px); }
    .edit-cancel-btn {
      padding: 7px 12px;
      background: transparent;
      color: var(--text-gray);
      border: 1px solid var(--border-subtle);
      border-radius: 6px;
      font-family: inherit;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      transition: all var(--trans);
      text-transform: uppercase;
    }
    .edit-cancel-btn:hover { background: rgba(0,0,0,0.04); }
    .edit-open-gcal-btn {
      padding: 7px 12px;
      background: rgba(66,133,244,0.08);
      color: #1558b0;
      border: 1px solid #c5d8fb;
      border-radius: 6px;
      font-family: inherit;
      font-size: 11px;
      font-weight: 700;
      cursor: pointer;
      transition: all var(--trans);
      text-transform: uppercase;
      letter-spacing: 0.03em;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }
    .edit-open-gcal-btn:hover { background: rgba(66,133,244,0.15); border-color: #4285F4; }
    .no-events-msg { text-align: center; padding: 28px 16px; color: var(--text-dim); font-size: 12px; font-weight: 500; }
    .events-panel-footer {
      padding: 10px 16px 12px;
      border-top: 1px solid #e0ecff;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      background: #f5f9ff;
    }
    .events-count-label { font-size: 10px; color: var(--text-dim); font-weight: 600; text-transform: uppercase; letter-spacing: 0.04em; }
    .clear-all-btn {
      font-size: 10px;
      color: #ef4444;
      background: none;
      border: none;
      cursor: pointer;
      font-family: inherit;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      padding: 4px 8px;
      border-radius: 4px;
      transition: all var(--trans);
    }
    .clear-all-btn:hover { background: #fff0f0; }
    .ssa-confirm-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.38);
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 200ms ease;
    }
    .ssa-confirm-overlay.show { opacity: 1; pointer-events: all; }
    .ssa-confirm-box {
      background: linear-gradient(135deg, #ffffff 0%, #fafaf8 100%);
      border: 1.5px solid var(--border-subtle);
      border-radius: 16px;
      padding: 24px 22px 20px;
      max-width: 340px;
      width: 100%;
      box-shadow: 0 24px 60px rgba(0,0,0,0.18);
      transform: translateY(12px) scale(0.97);
      transition: transform 220ms cubic-bezier(0.34,1.56,0.64,1), opacity 200ms ease;
      opacity: 0;
    }
    .ssa-confirm-overlay.show .ssa-confirm-box { transform: translateY(0) scale(1); opacity: 1; }
    .ssa-confirm-icon-wrap {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 14px;
    }
    .ssa-confirm-icon-wrap.danger { background: rgba(239,68,68,0.10); }
    .ssa-confirm-icon-wrap.warning { background: rgba(251,191,36,0.12); }
    .ssa-confirm-title { font-family: 'DM Serif Display', serif; font-size: 16px; font-weight: 700; color: var(--text-dark); margin-bottom: 6px; line-height: 1.3; }
    .ssa-confirm-msg { font-size: 12px; color: var(--text-gray); line-height: 1.65; margin-bottom: 20px; }
    .ssa-confirm-btns { display: flex; gap: 8px; justify-content: flex-end; }
    .ssa-confirm-cancel {
      padding: 9px 16px;
      background: transparent;
      color: var(--text-gray);
      border: 1.5px solid var(--border-subtle);
      border-radius: 8px;
      font-family: inherit;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
      transition: all var(--trans);
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }
    .ssa-confirm-cancel:hover { background: rgba(0,0,0,0.04); border-color: var(--accent-gold); }
    .ssa-confirm-ok {
      padding: 9px 18px;
      border: none;
      border-radius: 8px;
      font-family: inherit;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
      transition: all var(--trans);
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }
    .ssa-confirm-ok.danger { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: #fff; box-shadow: 0 4px 14px rgba(239,68,68,0.28); }
    .ssa-confirm-ok.danger:hover { background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%); transform: translateY(-1px); box-shadow: 0 6px 18px rgba(239,68,68,0.36); }
    .ssa-confirm-ok.warning { background: linear-gradient(135deg, #ffc62f 0%, #ffb700 100%); color: #1a1a1a; box-shadow: 0 4px 14px rgba(255,198,47,0.28); }
    .ssa-confirm-ok.warning:hover { background: linear-gradient(135deg, #ffb700 0%, #e0a800 100%); transform: translateY(-1px); }
  </style>
</head>
<body>
<div class="app">

  <header class="app-header">
    <div class="app-header__logo">
      <img src="assets/svg/logo-bolt.svg" width="16" height="16" alt="">
    </div>
    <span class="app-header__title">Soft Skills Assessment</span>
    <span class="app-header__sub">Psychometric Evaluation Tool</span>
  </header>

  <!-- WELCOME -->
  <section id="ssa-welcome" class="section">
    <div class="welcome-outer">
      <div class="welcome-grid">

        <div class="welcome-left">
          <div class="welcome-hero-tag">Psychometric Assessment</div>
          <h1 class="welcome-title">Discover your <em>soft skill</em> strengths</h1>
          <p class="welcome-desc">
            This assessment uses validated psychometric questions — real workplace scenarios,
            reflective statements, and behavioural items. Answer what feels relevant, skip the rest.
          </p>

          <div class="welcome-stats">
            <div class="welcome-stat">
              <div class="welcome-stat__num" id="stat-questions">20</div>
              <div class="welcome-stat__label">Questions Per Category</div>
            </div>
            <div class="welcome-stat">
              <div class="welcome-stat__num" id="stat-categories">4</div>
              <div class="welcome-stat__label">Categories</div>
            </div>
            <div class="welcome-stat">
              <div class="welcome-stat__num">~15</div>
              <div class="welcome-stat__label">Minutes</div>
            </div>
            <div class="welcome-stat">
              <div class="welcome-stat__num">5pt</div>
              <div class="welcome-stat__label">Likert Scale</div>
            </div>
          </div>

          <div class="cat-selector-block">
            <div class="cat-selector-label">
              <span>Choose categories to assess</span>
              <span class="cat-selector-hint">Select one or more</span>
            </div>
            <div id="cat-selector-grid" class="cat-selector-grid"></div>
          </div>

          <!-- Google Calendar Reminder -->
          <div class="gcal-reminder-section">
            <div class="gcal-reminder-header">
              <div class="gcal-reminder-icon">
                <img src="assets/svg/gcal-icon.svg" width="18" height="18" alt="Google Calendar">
              </div>
              <div class="gcal-reminder-title-wrap">
                <div class="gcal-reminder-title">Set a Reminder</div>
                <div class="gcal-reminder-sub">Add to Google Calendar</div>
              </div>
            </div>
            <div class="gcal-reminder-body">
              <div class="gcal-form-group">
                <label class="gcal-label" for="gcal-title">Event Title</label>
                <input class="gcal-input" type="text" id="gcal-title" placeholder="e.g. Soft Skills Review Session" maxlength="120">
                <span class="gcal-error" id="gcal-err-title"></span>
              </div>
              <div class="gcal-form-group">
                <label class="gcal-label" for="gcal-desc">Notes / Description</label>
                <textarea class="gcal-textarea" id="gcal-desc" rows="2" placeholder="Preparation notes, location, agenda..."></textarea>
              </div>
              <div class="gcal-form-row">
                <div class="gcal-form-group">
                  <label class="gcal-label" for="gcal-datetime">Date &amp; Time</label>
                  <input class="gcal-input" type="datetime-local" id="gcal-datetime">
                  <span class="gcal-error" id="gcal-err-datetime"></span>
                </div>
                <div class="gcal-form-group">
                  <label class="gcal-label" for="gcal-duration">Duration (mins)</label>
                  <input class="gcal-input" type="number" id="gcal-duration" value="60" min="5" max="480" step="5">
                </div>
              </div>
              <button class="gcal-btn" onclick="addToGoogleCalendar()">
                <img src="assets/svg/calendar-small.svg" width="14" height="14" alt="">
                Add to Google Calendar
              </button>
              <div class="gcal-success-msg" id="gcal-success">
                <img src="assets/svg/success.svg" width="14" height="14" alt="">
                Calendar opened in a new tab. Check your browser for the popup.
              </div>
            </div>

            <!-- MY EVENTS BUTTON + PANEL -->
            <div class="my-events-btn-wrap">
              <button class="my-events-toggle-btn" onclick="toggleEventsPanel()" id="my-events-toggle-btn">
                <img src="assets/svg/calendar-small.svg" width="14" height="14" alt="">
                My Saved Events
                <span class="my-events-badge" id="my-events-badge">0</span>
              </button>

              <div class="my-events-panel" id="my-events-panel">
                <div class="my-events-panel-header">
                  <div class="my-events-panel-title">
                    <img src="assets/svg/calendar-small.svg" width="15" height="15" alt="">
                    Scheduled Events
                  </div>
                  <button class="my-events-panel-close" onclick="toggleEventsPanel()">&#x2715;</button>
                </div>
                <div class="my-events-list" id="my-events-list"></div>
                <div class="events-panel-footer">
                  <span class="events-count-label" id="events-count-label">0 events</span>
                  <button class="clear-all-btn" onclick="clearAllEvents()">Clear All</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Right column: form card -->
        <div class="form-card">
          <div class="form-card__title">Begin your assessment</div>
          <div class="form-card__sub">Enter your details to generate a personalised report.</div>
          <form id="ssa-form" novalidate>
            <div class="form-group">
              <label class="form-label" for="inp-name">Full Name</label>
              <input class="form-input" type="text" id="inp-name" placeholder="e.g. Sarah Mitchell" maxlength="100" autocomplete="name">
              <span class="form-error" id="err-name"></span>
            </div>
            <div class="form-group">
              <label class="form-label" for="inp-role">Job Role</label>
              <input class="form-input" type="text" id="inp-role" placeholder="e.g. Product Manager" maxlength="100" autocomplete="organization-title">
              <span class="form-error" id="err-role"></span>
            </div>
            <div class="form-group" style="display:flex;align-items:center;gap:10px;margin-bottom:20px;">
              <input type="checkbox" id="ssa-enable-timer" style="width:18px;height:18px;cursor:pointer;">
              <label for="ssa-enable-timer" style="margin:0;font-size:13px;color:var(--text-gray);cursor:pointer;font-weight:500;">Enable timer for each question (optional)</label>
            </div>
            <div class="how-it-works-box">
              <strong class="how-it-works-title">How it works</strong>
              <div class="how-it-works-body">
                Rate each statement using a 5-point scale from <em>Strongly Agree</em> to <em>Strongly Disagree</em>.
                Questions mix workplace scenarios, reflective statements, and frequency-based items.
                You can skip any question, flag for review, and change answers before submitting.
              </div>
            </div>
            <button type="submit" class="btn btn-primary btn-lg btn-full" id="ssa-start-btn">
              Start Assessment
              <img src="assets/svg/arrow-right.svg" width="14" height="14" alt="">
            </button>
          </form>
        </div>

      </div>
    </div>
  </section>

  <!-- ASSESSMENT -->
  <section id="ssa-assessment" class="section">
    <div class="cat-tabs-bar">
      <div id="ssa-cat-tabs" class="cat-tabs-inner"></div>
    </div>
    <div class="q-dots-bar" id="ssa-q-dots"></div>
    <div class="q-card-wrap">
      <div class="q-card">
        <div class="q-card__meta">
          <span class="q-card__cat-badge" id="ssa-cat-label">Communication</span>
          <span class="q-card__num" id="ssa-q-num">Question 1 of 10</span>
          <div id="ssa-timer" style="font-size:11px;font-weight:700;color:#ffc62f;min-width:50px;text-align:right;">0:00</div>
        </div>
        <p class="q-card__text" id="ssa-q-text"></p>
        <div class="likert-options" id="ssa-likert"></div>
        <div class="q-actions">
          <button class="btn btn-ghost btn-sm" id="ssa-btn-prev-q">
            <img src="assets/svg/arrow-left.svg" width="14" height="14" alt="">
            Back
          </button>
          <div class="q-actions__right">
            <button class="btn btn-ghost btn-sm" id="ssa-btn-flag">
              <img src="assets/svg/flag.svg" width="13" height="13" alt="">
              Flag
            </button>
            <button class="btn btn-ghost btn-sm" id="ssa-btn-skip">
              <img src="assets/svg/skip.svg" width="13" height="13" alt="">
              Skip
            </button>
            <button class="btn btn-secondary btn-sm" id="ssa-btn-next-q">
              Next
              <img src="assets/svg/arrow-right.svg" width="14" height="14" alt="" class="btn-arrow-icon">
            </button>
          </div>
        </div>
      </div>
    </div>
    <div class="finish-early-bar">
      <div class="completion-requirement">
        <span class="completion-info" id="completion-status">Answer 50%+ to submit results</span>
      </div>
      <button class="btn btn-primary btn-sm" id="ssa-btn-finish-early">View Results</button>
    </div>
  </section>

  <!-- REVIEW -->
  <section id="ssa-review" class="section">
    <div class="review-outer">
      <div class="review-header">
        <h2>Review Your Assessment</h2>
        <p>Review your answers before final submission. You can change answers and flag questions for later review.</p>
      </div>
      <div class="review-stats-grid">
        <div class="review-stat-card">
          <div class="review-stat-badge" style="background:#86efac;color:#166534;font-size:13px;font-weight:800;">OK</div>
          <div class="review-stat-info">
            <div class="review-stat-label">Answered</div>
            <div class="review-stat-value" id="rev-answered-count">0</div>
          </div>
        </div>
        <div class="review-stat-card">
          <div class="review-stat-badge" style="background:#fbbf24;color:#78350f;font-size:20px;font-weight:800;">—</div>
          <div class="review-stat-info">
            <div class="review-stat-label">Skipped</div>
            <div class="review-stat-value" id="rev-skipped-count">0</div>
          </div>
        </div>
        <div class="review-stat-card">
          <div class="review-stat-badge" style="background:#fb923c;color:#7c2d12;font-size:20px;font-weight:800;">!</div>
          <div class="review-stat-info">
            <div class="review-stat-label">Not Answered</div>
            <div class="review-stat-value" id="rev-notanswered-count">0</div>
          </div>
        </div>
        <div class="review-stat-card">
          <div class="review-stat-badge" style="background:#60a5fa;color:#1e3a8a;display:flex;align-items:center;justify-content:center;">
            <img src="assets/svg/flag.svg" width="17" height="17" alt="">
          </div>
          <div class="review-stat-info">
            <div class="review-stat-label">Flagged for Review</div>
            <div class="review-stat-value" id="rev-flagged-count">0</div>
          </div>
        </div>
      </div>
      <div class="review-summary-section">
        <h3>Category Breakdown</h3>
        <div id="rev-summary-cards" class="review-cat-grid"></div>
      </div>
      <div class="review-actions">
        <button class="btn btn-ghost btn-sm" id="rev-btn-back">
          <img src="assets/svg/arrow-left.svg" width="14" height="14" alt="">
          Back to Assessment
        </button>
        <button class="btn btn-secondary btn-sm" id="rev-btn-review-flagged">
          <img src="assets/svg/flag.svg" width="13" height="13" alt="">
          Review Flagged
        </button>
        <button class="btn btn-primary btn-sm" id="rev-btn-submit">
          Submit &amp; View Results
          <img src="assets/svg/arrow-right.svg" width="14" height="14" alt="">
        </button>
      </div>
    </div>
  </section>

  <!-- RESULTS -->
  <section id="ssa-results" class="section">
    <div class="results-wrap">
      <div class="res-header">
        <div class="res-header__left">
          <h1>Assessment Results</h1>
          <p>
            <span id="res-name" style="font-weight:600;color:#1a1a1a;"></span>
            &nbsp;·&nbsp;
            <span id="res-role" style="color:#5a5a5a;"></span>
            &nbsp;·&nbsp;
            <span id="res-date" style="color:#8a8a8a;font-size:13px;"></span>
          </p>
        </div>
        <div class="res-actions">
          <button class="btn btn-secondary btn-sm" id="res-btn-restart">
            <img src="assets/svg/restart.svg" width="13" height="13" alt="">
            New Assessment
          </button>
          <button class="btn btn-primary btn-sm" id="res-btn-pdf">
            <img src="assets/svg/download.svg" width="13" height="13" alt="">
            Export PDF
          </button>
        </div>
      </div>
      <div class="res-overall">
        <div class="res-overall__circle" id="res-overall-circle">
          <div class="res-overall__circle-inner">
            <span class="res-overall__pct" id="res-overall-pct">—</span>
          </div>
        </div>
        <div class="res-overall__info">
          <h2>Overall Performance</h2>
          <div class="res-overall__level" id="res-overall-level">—</div>
          <p class="res-overall__desc">Based on your responses across all assessed categories. Skipped questions are excluded from scoring.</p>
        </div>
      </div>
      <div class="res-cat-grid" id="res-cat-cards"></div>
      <div class="res-charts">
        <div class="chart-card">
          <div class="chart-card__title">Competency Radar</div>
          <canvas id="chart-radar" width="340" height="300"></canvas>
        </div>
        <div class="chart-card">
          <div class="chart-card__title">Category Scores</div>
          <canvas id="chart-bar" width="340" height="300"></canvas>
        </div>
        <div class="chart-card chart-card--full">
          <div class="chart-card__title">Response Distribution (all answered questions)</div>
          <canvas id="chart-dist" width="700" height="220"></canvas>
        </div>
      </div>
    </div>
  </section>

  <footer class="app-footer">
    <span>Soft Skills Assessment Tool</span>
  </footer>

</div>

<!-- Custom Confirm Dialog -->
<div class="ssa-confirm-overlay" id="ssa-confirm-overlay" role="dialog" aria-modal="true">
  <div class="ssa-confirm-box" id="ssa-confirm-box">
    <div class="ssa-confirm-icon-wrap danger" id="ssa-confirm-icon-wrap">
      <img src="assets/svg/delete.svg" width="22" height="22" alt="">
    </div>
    <div class="ssa-confirm-title" id="ssa-confirm-title">Are you sure?</div>
    <div class="ssa-confirm-msg" id="ssa-confirm-msg">This action cannot be undone.</div>
    <div class="ssa-confirm-btns">
      <button class="ssa-confirm-cancel" id="ssa-confirm-cancel">Cancel</button>
      <button class="ssa-confirm-ok danger" id="ssa-confirm-ok">Confirm</button>
    </div>
  </div>
</div>

<div id="ssa-toast" class="ssa-toast" role="status" aria-live="polite"></div>

<script src="js/app.js" defer></script>

<script>
  (function setDefaultDateTime() {
    const inp = document.getElementById('gcal-datetime');
    if (!inp) return;
    const d = new Date(Date.now() + 60 * 60 * 1000);
    const pad = n => n.toString().padStart(2, '0');
    inp.value = d.getFullYear() + '-' + pad(d.getMonth()+1) + '-' + pad(d.getDate()) +
                'T' + pad(d.getHours()) + ':' + pad(d.getMinutes());
  })();

  const EVENTS_KEY = 'ssa_gcal_events';

  function loadEvents() {
    try { const raw = localStorage.getItem(EVENTS_KEY); return raw ? JSON.parse(raw) : []; } catch (_) { return []; }
  }
  function saveEvents(events) {
    try { localStorage.setItem(EVENTS_KEY, JSON.stringify(events)); } catch (_) {}
  }
  function updateEventsBadge() {
    const badge = document.getElementById('my-events-badge');
    if (badge) badge.textContent = loadEvents().length;
  }

  const ICON = {
    clock:        'Time',
    clockGrey:    'Time',
    calendar:     'Date',
    calendarEmpty:'',
    edit:         '&#x270E;',
    delete:       '&#x2715;',
    externalLink: 'Open',
    success:      'Save',
  };

  function addToGoogleCalendar() {
    const title    = document.getElementById('gcal-title').value.trim();
    const desc     = document.getElementById('gcal-desc').value.trim();
    const datetime = document.getElementById('gcal-datetime').value;
    const duration = parseInt(document.getElementById('gcal-duration').value, 10) || 60;

    document.getElementById('gcal-err-title').textContent    = '';
    document.getElementById('gcal-err-datetime').textContent = '';
    document.getElementById('gcal-success').classList.remove('show');

    let valid = true;
    if (!title || title.length < 2) { document.getElementById('gcal-err-title').textContent = 'Please enter an event title.'; valid = false; }
    if (!datetime) { document.getElementById('gcal-err-datetime').textContent = 'Please choose a date and time.'; valid = false; }
    if (!valid) return;

    function formatGCal(date) {
      const pad = n => n.toString().padStart(2, '0');
      return date.getFullYear() + pad(date.getMonth()+1) + pad(date.getDate()) + 'T' + pad(date.getHours()) + pad(date.getMinutes()) + pad(date.getSeconds());
    }

    const startDate = new Date(datetime);
    const endDate   = new Date(startDate.getTime() + duration * 60 * 1000);
    const url = 'https://calendar.google.com/calendar/render?action=TEMPLATE' +
                '&text=' + encodeURIComponent(title) +
                '&details=' + encodeURIComponent(desc || 'Scheduled via Soft Skills Assessment Tool') +
                '&dates=' + formatGCal(startDate) + '/' + formatGCal(endDate);

    window.open(url, '_blank');

    const events = loadEvents();
    events.push({ id: Date.now().toString(), title, desc, datetime, duration, createdAt: new Date().toISOString() });
    saveEvents(events);
    updateEventsBadge();

    document.getElementById('gcal-success').classList.add('show');
    setTimeout(() => document.getElementById('gcal-success').classList.remove('show'), 5000);

    if (document.getElementById('my-events-panel').classList.contains('open')) renderEventsList();
  }

  function toggleEventsPanel() {
    const panel = document.getElementById('my-events-panel');
    if (panel.classList.contains('open')) { panel.classList.remove('open'); }
    else { panel.classList.add('open'); renderEventsList(); }
  }

  function renderEventsList() {
    const events = loadEvents();
    const list   = document.getElementById('my-events-list');
    const countLabel = document.getElementById('events-count-label');
    if (!list) return;

    countLabel.textContent = events.length === 1 ? '1 event' : `${events.length} events`;

    if (events.length === 0) {
      list.innerHTML = `<div class="no-events-msg">No events saved yet.<br>Add one using the form above.</div>`;
      return;
    }

    const now = new Date();
    const sorted = [...events].sort((a, b) => {
      const da = new Date(a.datetime), db = new Date(b.datetime);
      const aF = da >= now, bF = db >= now;
      if (aF && !bF) return -1; if (!aF && bF) return 1;
      return aF ? da - db : db - da;
    });

    list.innerHTML = '';
    sorted.forEach(ev => {
      const evDate     = new Date(ev.datetime);
      const isFuture   = evDate >= now;
      const endDate    = new Date(evDate.getTime() + ev.duration * 60 * 1000);
      const dateStr    = evDate.toLocaleDateString('en-GB', { weekday:'short', day:'numeric', month:'short', year:'numeric' });
      const timeStr    = evDate.toLocaleTimeString('en-GB', { hour:'2-digit', minute:'2-digit' });
      const endTimeStr = endDate.toLocaleTimeString('en-GB', { hour:'2-digit', minute:'2-digit' });
      const pad = n => n.toString().padStart(2, '0');
      const dtLocal = evDate.getFullYear() + '-' + pad(evDate.getMonth()+1) + '-' + pad(evDate.getDate()) +
                      'T' + pad(evDate.getHours()) + ':' + pad(evDate.getMinutes());

      const card = document.createElement('div');
      card.className = 'event-card';
      card.dataset.id = ev.id;
      card.innerHTML = `
        <div class="event-view">
          <div class="event-view__title">${escHtml(ev.title)}</div>
          <div class="event-view__meta">
            <span class="event-chip ${isFuture ? 'future' : 'past'}">${isFuture ? ICON.clock : ICON.clockGrey} ${isFuture ? 'Upcoming' : 'Past'}</span>
            <span class="event-chip">${ICON.calendar} ${dateStr}</span>
            <span class="event-chip">${ICON.clock} ${timeStr} – ${endTimeStr}</span>
            <span class="event-chip">${ev.duration} min</span>
          </div>
          ${ev.desc ? `<div class="event-view__desc">${escHtml(ev.desc)}</div>` : ''}
        </div>
        <div class="event-actions">
          <button class="event-action-btn" title="Edit" onclick="startEditEvent('${ev.id}')">${ICON.edit}</button>
          <button class="event-action-btn delete" title="Delete" onclick="deleteEvent('${ev.id}')">${ICON.delete}</button>
        </div>
        <div class="event-edit">
          <div class="edit-field">
            <label class="edit-label">Event Title</label>
            <input class="edit-input" type="text" id="edit-title-${ev.id}" value="${escHtml(ev.title)}" maxlength="120">
          </div>
          <div class="edit-field">
            <label class="edit-label">Notes / Description</label>
            <textarea class="edit-textarea" id="edit-desc-${ev.id}" rows="2">${escHtml(ev.desc || '')}</textarea>
          </div>
          <div class="edit-row">
            <div class="edit-field">
              <label class="edit-label">Date &amp; Time</label>
              <input class="edit-input" type="datetime-local" id="edit-dt-${ev.id}" value="${dtLocal}">
            </div>
            <div class="edit-field">
              <label class="edit-label">Duration (mins)</label>
              <input class="edit-input" type="number" id="edit-dur-${ev.id}" value="${ev.duration}" min="5" max="480" step="5">
            </div>
          </div>
          <div class="edit-btns">
            <button class="edit-cancel-btn" onclick="cancelEditEvent('${ev.id}')">Cancel</button>
            <button class="edit-open-gcal-btn" onclick="openUpdatedInGcal('${ev.id}')">${ICON.externalLink}</button>
            <button class="edit-save-btn" onclick="saveEditEvent('${ev.id}')">${ICON.success}</button>
          </div>
        </div>`;
      list.appendChild(card);
    });
  }

  function startEditEvent(id) { const c = document.querySelector(`.event-card[data-id="${id}"]`); if (c) c.classList.add('editing'); }
  function cancelEditEvent(id) { const c = document.querySelector(`.event-card[data-id="${id}"]`); if (c) c.classList.remove('editing'); }

  function saveEditEvent(id) {
    const titleEl = document.getElementById(`edit-title-${id}`);
    const descEl  = document.getElementById(`edit-desc-${id}`);
    const dtEl    = document.getElementById(`edit-dt-${id}`);
    const durEl   = document.getElementById(`edit-dur-${id}`);
    const newTitle = titleEl ? titleEl.value.trim() : '';
    if (!newTitle || newTitle.length < 2) {
      titleEl && (titleEl.style.borderColor = '#ef4444');
      setTimeout(() => titleEl && (titleEl.style.borderColor = ''), 2000);
      return;
    }
    const events = loadEvents();
    const idx = events.findIndex(e => e.id === id);
    if (idx === -1) return;
    events[idx].title     = newTitle;
    events[idx].desc      = descEl ? descEl.value.trim() : '';
    events[idx].datetime  = dtEl ? dtEl.value : events[idx].datetime;
    events[idx].duration  = durEl ? (parseInt(durEl.value, 10) || 60) : events[idx].duration;
    events[idx].updatedAt = new Date().toISOString();
    saveEvents(events); updateEventsBadge(); renderEventsList();
    showSSAToast('Event updated successfully!', 'success');
  }

  function deleteEvent(id) {
    ssaConfirm({
      title: 'Delete Event?',
      msg: 'This event will be permanently removed from your saved list.',
      okLabel: 'Delete', type: 'danger',
      onOk: () => {
        saveEvents(loadEvents().filter(e => e.id !== id));
        updateEventsBadge(); renderEventsList();
        showSSAToast('Event deleted.', 'info');
      }
    });
  }

  function clearAllEvents() {
    const count = loadEvents().length;
    if (count === 0) { showSSAToast('No events to clear.', 'warning'); return; }
    ssaConfirm({
      title: 'Clear All Events?',
      msg: `This will permanently remove all ${count} saved event${count !== 1 ? 's' : ''}. This cannot be undone.`,
      okLabel: 'Clear All', type: 'danger',
      onOk: () => {
        saveEvents([]); updateEventsBadge(); renderEventsList();
        showSSAToast('All events cleared.', 'info');
      }
    });
  }

  let _confirmCleanup = null;
  function ssaConfirm({ title, msg, okLabel = 'Confirm', type = 'danger', onOk }) {
    const overlay   = document.getElementById('ssa-confirm-overlay');
    const titleEl   = document.getElementById('ssa-confirm-title');
    const msgEl     = document.getElementById('ssa-confirm-msg');
    const okBtn     = document.getElementById('ssa-confirm-ok');
    const cancelBtn = document.getElementById('ssa-confirm-cancel');
    const iconWrap  = document.getElementById('ssa-confirm-icon-wrap');
    titleEl.textContent = title; msgEl.textContent = msg; okBtn.textContent = okLabel;
    okBtn.className = `ssa-confirm-ok ${type}`;
    iconWrap.className = `ssa-confirm-icon-wrap ${type}`;
    overlay.classList.add('show');
    if (_confirmCleanup) _confirmCleanup();
    function close()          { overlay.classList.remove('show'); }
    function handleOk()       { close(); if (typeof onOk === 'function') onOk(); }
    function handleCancel()   { close(); }
    function handleOverlay(e) { if (e.target === overlay) close(); }
    function handleKey(e)     { if (e.key === 'Escape') close(); if (e.key === 'Enter') handleOk(); }
    okBtn.addEventListener('click', handleOk);
    cancelBtn.addEventListener('click', handleCancel);
    overlay.addEventListener('click', handleOverlay);
    document.addEventListener('keydown', handleKey);
    _confirmCleanup = () => {
      okBtn.removeEventListener('click', handleOk);
      cancelBtn.removeEventListener('click', handleCancel);
      overlay.removeEventListener('click', handleOverlay);
      document.removeEventListener('keydown', handleKey);
    };
    setTimeout(() => okBtn.focus(), 50);
  }

  function openUpdatedInGcal(id) {
    const titleEl = document.getElementById(`edit-title-${id}`);
    const descEl  = document.getElementById(`edit-desc-${id}`);
    const dtEl    = document.getElementById(`edit-dt-${id}`);
    const durEl   = document.getElementById(`edit-dur-${id}`);
    const title    = titleEl ? titleEl.value.trim() : '';
    const desc     = descEl ? descEl.value.trim() : '';
    const datetime = dtEl ? dtEl.value : '';
    const duration = durEl ? (parseInt(durEl.value, 10) || 60) : 60;
    if (!title || !datetime) { showSSAToast('Please fill in title and date/time first.', 'warning'); return; }
    function formatGCal(date) {
      const pad = n => n.toString().padStart(2, '0');
      return date.getFullYear() + pad(date.getMonth()+1) + pad(date.getDate()) + 'T' + pad(date.getHours()) + pad(date.getMinutes()) + pad(date.getSeconds());
    }
    const startDate = new Date(datetime);
    const endDate   = new Date(startDate.getTime() + duration * 60 * 1000);
    const url = 'https://calendar.google.com/calendar/render?action=TEMPLATE' +
                '&text=' + encodeURIComponent(title) +
                '&details=' + encodeURIComponent(desc || 'Scheduled via Soft Skills Assessment Tool') +
                '&dates=' + formatGCal(startDate) + '/' + formatGCal(endDate);
    window.open(url, '_blank');
    showSSAToast('Calendar opened in new tab.', 'success');
  }

  function escHtml(str) {
    return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;');
  }

  function showSSAToast(msg, type) {
    const t = document.getElementById('ssa-toast');
    if (!t) return;
    t.textContent = msg;
    t.className = `ssa-toast ssa-toast--${type} show`;
    setTimeout(() => t.classList.remove('show'), 3500);
  }

  document.addEventListener('DOMContentLoaded', function() { updateEventsBadge(); });
</script>
</body>
</html>